# Telegram Bot Channel Utils

This project is a Telegram bot that, in the future, will be able to generate heatmaps for any financial asset and compose an image with it combined
with the candlestick data for that asset. The updates can be posted on a time basis to telegram channels, configurable by user input, or generated
on-demand by interacting with the bot manually or by using a command in a channel.

## Current features

- Listens for configuration commands from the telegram channels it's in.
- Registers individual pair lists and timeframes for each of those pairs, set separately and independently for each channel.
- Has logging capabilities for the messages it receives and other updates, configurable via the `logger.py` module.
- Periodically sends liquidation heatmap charts to each channel, with the selected pair list.

## Requirements

- Python 3.12
- The requirements in `requirements.txt`

## Installation

1. Clone the repository:
    ```sh
    git clone https://github.com/thewitcher745/heatmap-bot
    cd telegram-bot-channel-utils
    ```

2. Install the required dependencies:
    ```sh
    pip install -r requirements.txt
    ```

3. Set up your bot token in a `.env.secret` file, located in the root:
    ```python
    BOT_TOKEN = 'your-telegram-bot-token'
    ```
4. Launch the project by running `python main.py` in the project root directory.

5. Add the bot to your desired channel through Telegram.

6. Use the various commands to interact with the bot.

## Project Structure

- `channel/channel_utils.py`: Utility script for handling things related to channel messages.
- `utils/logger.py`: Logger utility for logging messages.
- `data/`: Directory for things related to the image generation, handling data, etc. The numbers, Mason!
- `logs/`: Directory for the logs generated by the bot.
- `output_images/`: Directory for the output images generated by the bot.
- `constants.py`: Contains the constants that make the bot work.

## Bot commands

- `/addpair`: Adds a pair to the list of pairs for the channel. (Requires restart to take effect)
- `/showpairs`: Shows the list of pairs added to the channel.
- `/setinterval`: Sets the interval for the bot to send messages to the channel. ((Requires restart)
- `/currentchart`: Generates a heatmap for the selected pair list and sends it to the channel.

## Changelog

### ver b0.1

- Implemented rudimentary candlestick charting utility in `data/plotting.py`
- Implemented basic logging utility in `utils/logger.py`
- Implemented basic channel message handling utility in `channel/channel_utils.py`. This will be expanded upon majorly in the future.

### ver b0.2

- Implemented config file reading and writing in `utils/config_manager.py`
- Implemented periodic message sending, later to be updated with the actual images.
- Added commands to add pairs to and show the list of pairs (/addpair and /showpairs) and a command to adjust the posting interval (/setinterval) for
  each channel.
- Updated get_candlestick to get_pair_data and cleaned up its code

### ver b0.3

- Completely changed how the chart is made. Now screenshots the heatmap from a website, after selecting the pair from the website GUI by webscraping.
  First the website is loaded, then the chart is scrolled into view, then the whole website gets screenshotted before being cropped using PIL.
- Added a command to generate the liquidation heatmap on-demand (/currentchart).
- Removed timeframe setting for the pairs, since the website does not offer timeframe selection. 
